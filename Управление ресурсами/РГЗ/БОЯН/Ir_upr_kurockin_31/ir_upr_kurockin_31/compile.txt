echo off
cls
set path1="NULLPATH"
echo Looking for "vcvarsall.bat"...
if exist "C:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="C:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "D:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="D:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "E:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="E:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "F:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="F:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "G:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="G:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "I:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="I:\Program Files\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "C:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="C:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "D:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="D:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "E:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="E:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "F:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="F:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "G:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="G:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "I:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat" set path1="I:\Program Files (x86)\Microsoft Visual Studio 8.0\VC\vcvarsall.bat"
if exist "C:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="C:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "D:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="D:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "E:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="E:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "F:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="F:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "G:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="G:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "I:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="I:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "D:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="D:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "E:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="E:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "F:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="F:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "G:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="G:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "I:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat" set path1="I:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcvarsall.bat"
if exist "C:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="C:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "D:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="D:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "E:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="E:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "F:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="F:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "G:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="G:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "I:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="I:\Program Files\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "D:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="D:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "E:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="E:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "F:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="F:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "G:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="G:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "I:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" set path1="I:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat"
if exist "C:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="C:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "D:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="D:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "E:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="E:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "F:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="F:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "G:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="G:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "I:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="I:\Program Files\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "D:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="D:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "E:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="E:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "F:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="F:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "G:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="G:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if exist "I:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat" set path1="I:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\vcvarsall.bat"
if /I %path1%=="NULLPATH" (echo Unable to find "vcvarsall.bat"!) else (echo FOUND!)
if /I %path1%=="NULLPATH" pause else (echo %path1%)
if /I %path1%=="NULLPATH" EXIT
call %path1%
echo Clearing project...
if exist *.exe del *.exe
if exist *.dll del *.dll
if exist *.obj del *.obj
if exist *.lib del *.lib
if exist *.exp del *.exp
echo Now there are so tidy, that a surgery will envy!
echo We able to compile the main module!
cl rgr_mr.cpp kernel32.lib user32.lib gdi32.lib advapi32.lib
echo Compiling complete!
echo Compiling of the dynamic library is now available!
cl /LD winlib.cpp kernel32.lib user32.lib gdi32.lib advapi32.lib
echo Compiling complete!
echo Some trash extermination...
del *.obj *.lib *.exp
echo Exterminated!
echo Now all the work had been finished. Press any key.
pause

